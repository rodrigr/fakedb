<!DOCTYPE html>
<html lang="en">
    <head>
    <title>Vue</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <meta charset="utf-8">
    <style type="text/css">
       .pic{
        width: 100px;
       }
    </style>
    </head>
    
        
    <body>

        <div id="app" class="container">

            <ul>
                <li v-for="(student,index) in students">{{index + 1}} {{student.first_name}} {{student.middle_name}} {{student.last_name}}</li>
            </ul>

            <form onsubmit="return false">
                <label v-for="team in getKeyValue(students,'team')">
                    <input type="checkbox" name="team" :value="team" v-model="teams">
                    {{team}}
                </label>
            </form>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th v-for="(value,key) in students[0]">{{toPhrase(key)}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="student in filterStudents">
                        <td v-for="(value,key) in student">
                            <template v-if="key == 'photo' && value != null">
                                <img class="pic" :src="'https://raw.githubusercontent.com/rodrigr/myfakedb/master/img/'+ value">
                            </template>
                            <template v-else-if="key == 'photo' && value == null">
                                <img class="pic" src="https://raw.githubusercontent.com/rodrigr/myfakedb/master/img/default.png">
                            </template>
                            <template v-else>
                                {{value}}
                            </template>
                            
                        </td>
                    </tr>
                </tbody>
            </table>
            
            

        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    	<script>
            const app = new Vue({
                el: '#app',
                data:{
                    url: "https://raw.githubusercontent.com/rodrigr/myfakedb/master/db.json",
                    init: {
                        method: 'GET',
                    },
                    students: [],
                    teams: []
                },
                created(){
                    fetch(this.url, this.init)
                    .then(function(res){
                        if(res.ok){
                            return res.json()
                        } else{
                            throw new Error(res.status)
                        }
                    })
                    .then(function(json){
                        app.students = json.students
                        app.teams = app.getKeyValue(json.students,"team")
                    })
                    .catch(function(error){
                        console.log(error)
                    })
                },
                methods:{
                    toPhrase(string){
                        if(string.length > 1){
                            return string.split("_").map(e => e[0].toUpperCase() + e.slice(1)).join(" ")
                        }else{
                            return string[0].toUpperCase() + string.slice(1)
                        }
                    },
                    getKeyValue(array,key){
                        let result = []
                        array.forEach(e => !result.includes(e[key]) ? result.push(e[key]) : null)

                        return result
                    }
                },
                computed:{
                    filterStudents(){
                        return this.students.filter(e => app.teams.includes(e.team))
                    }
                }
                // components: {
                //     std:{
                //         props: ["name","note","index"],
                //         template: `
                //                     <div class='std'>
                //                     <p>{{index}}</p>
                //                     <p>Name: {{name}}</p>
                //                     <p>Note: {{note}}</p>
                //                     </div>
                //         `
                //     }
                // }
            })
        </script>
</body>
</html>